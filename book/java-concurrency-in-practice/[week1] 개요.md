# 개요
- 스레드는 자바의 피할 수 없는 특성
- 스레드의 사용은 멀티 프로세서 시스템을 최대한으로 활용하는 방법

## 1.1 작업을 동시에 실행하는 일에 대한 간략한 역사
- 여러 프로그램을 동시에 실행할 수 있는 운영체제를 개발하게된 요인
	- **자원활용** : 하나의 프로그램이 입출력과 같은 외부 동작이 끝나기를 대기하는 동안, 다른 프로그램을 실행하게 하는 것이 효율적
	- **공정성** : 여러 사용자/프로그램은 컴퓨터 내 자원에 대하여 동일한 권한을 가질 수 있음
	- **편의성** : 여러 작업을 처리하는 하나의 프로그램보다 각기 일을 처리하고 조율하는 프로그램이 쉽고 바람직함
- 프로세스 개념을 만들어내게 된 것과 같은 이유로 스레드가 고안됨
- 스레드로 인해 한 프로세스 안에 여러개의 프로그램 제어 흐름이 공존 가능함
- 스레드는 별도의 프로그램 카운터, **스택**, 지역 변수를 갖음
- 한 프로그램 내 여러 스레드를 동시에 여러 개의 CPU에 할당해 실행 가능함
- 의도적으로 스레드를 조율하지 않는 이상, 각 스레드는 서로 상관없이 비동기적으로 실행됨
- 한 프로세스 내 **모든 스레드는 동일한 heap에 객체를 할당함**
	- 데이터 공유 가능, 데이터에 대한 적절한 동기화가 필요

</br>

## 1.2 스레드의 이점
- 멀티프로세서 활용
	- 프로세서 스케줄링의 기본 단위는 스레드
		- 즉, 스레드 하나로 동작하는 프로그램은 한번에 최대 한개의 프로세서만 사용
	- 제대로 설계된 멀티스레드 프로그램은 프로세서 자원을 최대한으로 활용하여 처리 속도를 높일 수 있음
	- 스레드 하나가 I/O가 끝나길 기다리는 동안에도 다른 스레드는 동작할 수 있음
- 단순한 모델링
	- 종류별 작업마다 스레드를 할당하여 순차적인 작업처럼 처리 가능
		- 스케쥴링, 비동기 I/O, 자원대기 등의 부분과 비즈니스 로직의 분리 가능
- 단순한 비동기 이벤트 처리
	- 단일 스레드에서는 NIO(논블록킹 IO)를 사용하여 병행 처리, 복잡함
	- 멀티 스레드에서는 IO를 처리하는 스레드를 별도로 두고 처리, 논블록킹에 비해 단순함
- 더 빨리 반응하는 사용자 인터페이스 
	- 이벤트 핸들러를 별도의 스레드로 구현

</br>

## 1.3 스레드 사용의 위험성
- 안정성 위해 요소
	- 여러 스레드에서 하나의 변수를 공유하는 경우, 문제 발생 가능성 존재 (Race condition)
	- 공유된 변수를 적절히 동기화 해야함  
	![1-2_thread-ex](/img/1-2_thread-ex.png)  
- 활동성 위험
	- 어떤 작업이 전혀 진전되지 못하는 상태에 빠질 때 활동성(liveness) 장애가 발생했다고 함
	- 무한 루프로 인해 다음 코드가 절대 실행되지 않는 경우가 대표적인 예
	- 스레드를 사용하면 활동성 관련 문제 위험성이 높음
		- 스레드A 에서 스레드B가 독점하고 있는 자원을 기다리고 있을 때, 스레드B가 해당 자원을 놓치 않는다면..?
	- 데드락(deadlock), 소모상태(starvation), 라이브락(livelock) 등의 활동성 장애 유형이 존재
- 성능 위험
	- 스레드가 많은 프로그램에서는 context switching이 빈번하고 이로 인해 상당한 부담이 존재함
		- 실행중인 context를 저장하고 다시 읽어들여야 하며, 메모리를 읽고 쓰는데 있어 지역성이 손실되고 CPU를 스케쥴링하는데 소모해야함
	- 데이터를 공유하는 경우, 동기화 수단을 제공해야 하므로 이로인해 컴파일러 최적화가 어려움

</br>

## 1.4 스레드는 어디에나
- 

